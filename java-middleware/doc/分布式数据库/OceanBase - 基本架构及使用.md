

OceanBase 社区版是一款开源分布式 HTAP（Hybrid Transactional/Analytical Processing）数据库管理系统，具有原生分布式架构，支持金融级高可用、透明水平扩展、分布式事务、多租户和语法兼容等企业级特性。OceanBase 内核通过大规模商用场景的考验，已服务众多行业客户，现面向未来持续构建内核技术竞争力。

参考文档：
https://www.oceanbase.com/
https://github.com/alibaba/oceanbase

## 周边产品
OceanBase 数据库内核：SQL引擎、Oracle兼容、HTAP、分布式事务、Paxos多节点选主强一致性、透明可拓展的分布式存储
ODC 面向开发者工具平台：连接管理、数据库对象管理、SQL工作台、存储过程开发调试、导入导出
OCP 面向运维者工具平台
OMS 数据库迁移平台

## 核心特性
分布式  集群形式部署，支持水平拓展
多租户  按需分配实例，在线扩容、缩容
高可用  基于Paxos协议，强一致性同步。少数副本恢复，数据不丢。

OceanBase集群下多个Zone（每个Zone里面包含一份全量数据），每个Zone下多个OBServer，多个ObServer划分资源构成资源池，管理员把资源池授权给用户使用。
用户使用资源池创建数据库、创建表、创建分区，OB自动创建分区副本。数据由上层应用层进行同步，不需要基于任何共享存储，基于分区粒度的同步带来分区粒度的高可用。

每一个ObSerer里面含总控服务、SQL引擎、存储引擎和真正的磁盘分区。
SQL引擎：SQL解析、执行计划、连接算法、SQL注释、大纲、SQL审计


## LST Tree存储引擎
LSM Tree把随机写转换为顺序写，读是合并读，读写分离。
OB创新：增量写延迟落盘、LST Tree最多三层、cache加速。

基于LSM Tree的读写分离存储引擎，准内存数据库、充分利用SSD实现高速写入，对联机事务比较友好。


## 多租户
租户分配到的是逻辑实例，按需分配。节点上跑ObServer、多个节点组成一个Ob集群，对外带上租户信息提供给租户。租户分配到资源池中的资源单元。资源池是逻辑概念。

## 实例高可用
分区多副本基于应用层进行数据存储，定期Paxos选举进行选主，分布式代理ObProxy只做SQL路由，不做运算。
OBproxy路由：路由策略，以事务为单位，第一条SQL转发到表主副本所在节点，第二条SQL跟随第一条SQL。


## 开发运维规范
1.建表时加逐渐
2.大查询、大跑批在会话级别调大事务超时时间
3.不要有大事务，事务更新控制在10w条。大事务拆分为小事务，并行处理。


## 事务
在使用commit语句提交事务之前：
* 修改只对当前会话可见，对其他数据库会话不可见。
* 修改没有持久化，可以通过rollback语句撤销修改。

在使用commit语句提交事务之后：
* 修改对所有数据库会话可见。
* 修改持久化成功，不能通过rollback语句回滚修改。


使用rollback命令可以回滚整个当前未提交的事务，也可以回滚到事务中任意一个保存点。

## 锁
暂无传统意义上的死锁检测功能，通过锁超时控制解决死锁问题。
select for update只支持单表。

## 性能问题分析
1.分析缓存SQL的执行计划
2.分析SQL的审计视图

