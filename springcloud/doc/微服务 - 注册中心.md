
服务注册和发现机制作为微服务可拓展性的基础，注册中心自然就是微服务的核心模块。

## 1.服务注册

* 使用DNS作为服务发现机制。
优点：通用性高，基本所有操作系统、编程语言都支持。
缺点：灵活性差，无法定制、端口无法转换等
实际落地：Kubernetes中的CoreDNS

* 私有协议的服务注册机制
优点：可描述更多服务元信息（服务地址、描述、健康状态、心跳、版本、地域等）
缺点：和客户端绑定。


## 各注册中心对比

* Eureka 
AP系统，保证数据可用性。当出现节点网络问题，会出现访问不同节点得到的注册结果不一致。
需要使用SDK接入，不过由于本质是使用HTTP请求接入，所以异构系统其实也可以接入，可以自己使用SideCar去请求Eureka Server端即可。
使用客户端心跳进行健康检查。支持TTL，一段时间没有心跳就会删除客户端。

* Consul
CP系统，保证数据一致性。当节点出现网络问题，在选主期间服务不可用。基于Raft协议选主。
应用外注册，使用consul-template、envconsul等工具集成。
支持客户端心跳和服务端主动健康检查两种模式，支持TTL。
腾讯的Istio就使用了Consul

* Zookeeper
CP系统，保证数据一致性。当节点出现网络问题，在选主期间服务不可用。基于Paxos协议选主。
需要使用SDK接入，跨语言支持弱，且不是专门的注册中心，需要自己建模。
健康检查依赖长连接和Keepalived。

