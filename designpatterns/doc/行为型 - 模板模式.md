

模板模式是设计模式中的行为模式。
准备一个抽象类，将部分逻辑以具体方法的形式实现，然后声明一些抽象方法来迫使子类实现剩余的逻辑。不同子类具体不同方法实现这些抽象方法，从而对剩余逻辑有不同实现。
模板模式的关键在于：父类提供框架性的公共逻辑，子类提供个性化的逻辑定制。

一般模板方法会有模板方法（骨架方法）和钩子方法。通过定义好一个模式，使用者在模板实现之上能创造出基于模板的产品。AQS就是一个典型的模板方法。
模板模式将不变的部分封装在基类的骨架方法中，从而将变化的部分通过钩子方法进行封装，交给子类提供具体实现。

AQS为不同的资源共享方式提供了不同的模板流程，包括共享锁、独占锁的模板流程。由模板流程完成具体线程进出等待队列（如获取资源失败入队/唤醒出队）、通用逻辑，相当于基于这些逻辑完成了通用框架。
而自定义的同步器只要实现共享资源state的获取和释放即可，这些逻辑放在钩子方法里。

AQS需要重写的钩子方法有：
tryAcquire(int)  独占尝试获取资源
tryRelease(int)  独占尝试释放资源
tryAcquireShare(int)  共享尝试获取资源
tryReleaseShare(int)  共享尝试释放资源
isHeldExclusive()     独占判断线程是否独占资源

除了以上5个钩子方法，AQS其他方法,比如acquire()、release()都被final类型方法，无法被其他类继承。
lock() -> acquire() -> tryAcquire() -> addWaiter() -> acquireQueued() 